<script type="text/javascript">
	var BASE_URL = location.protocol + "//" +	"" + document.location.host	+ window.location.pathname;
	function sendRedirect(url){
		window.location.href = getBaseUrlOfSite()+url;
	}
	function sendRedirectWithBase(url){
		window.location.href = url;
		return false;
	}
	function doRedirect(obj) {
        window.location.href = getBaseUrlOfSite()+obj.getAttribute("href");
        return false;
    }

</script>
	<script type="text/javascript">
	    var dropDownValueSelectVal=false;
		function searchByKeyword(path){
			var keyWord=$("#search_home_control").val();
			keyWord = keyWord.replace(/[`%^\#",\{\}\[\]\\\/]/gi, '');
			if(keyWord=="" || keyWord==null || keyWord==undefined)
				return;
			if(keyWord.charAt(keyWord.length-1)=="?")
				keyWord=keyWord.substring(0,keyWord.length-1);
			
			var checkContext = window.location.href.split("/");
			if(checkContext.length >=5){
				var url = getBaseUrlOfSite();
				window.location.href = url + path+"?keyWord="+replaceSpaceWithhyphen(keyWord);					
			}
			else{
				var index = BASE_URL.lastIndexOf('/');
				var url = BASE_URL.substring(0,index + 1);
				window.location.href = url + path+"?keyWord="+replaceSpaceWithhyphen(keyWord);	
			}					
	 	}		
	</script>
	<script>
	var urlQuery="";
	var externleUrl="";
	var resourceUrl="";
	var tagsUrl="";
	var questionPageFlag=false;
	var brandPageFlag=false;
	$(document).ready(function () {
		var checkContext = window.location.href.split("/");
		var length = checkContext.length;
		for(i=length-1;i>=0;i--){
			if(checkContext[i]=="brand"){
				brandPageFlag=true;
				break;
			}
			if(checkContext[i]=="question"){				
				questionPageFlag=true;
				break;
			}
		}
		
		if(questionPageFlag==true || brandPageFlag == true){
			if(questionPageFlag==true)
			{
				urlQuery = '../../api/posts/questions/query?keyword=%QUERY';
				externleUrl='../../api/external-resource/query?keyword=%QUERY';
				resourceUrl='../../api/posts/brands/query?keyword=%QUERY';
				tagsUrl='../../api/tags/query?keyword=%QUERY';
			}
			if(brandPageFlag==true){
				urlQuery = '../api/posts/questions/query?keyword=%QUERY';
				externleUrl='../api/external-resource/query?keyword=%QUERY';
				resourceUrl='../api/posts/brands/query?keyword=%QUERY';
				tagsUrl='../api/tags/query?keyword=%QUERY';
			}			
		}
		else{
			urlQuery = 'api/posts/questions/query?keyword=%QUERY';
			externleUrl='api/external-resource/query?keyword=%QUERY';
			resourceUrl='api/posts/brands/query?keyword=%QUERY';
			tagsUrl='api/tags/query?keyword=%QUERY';
		}
		$('#search_home_control').typeahead([ 
		     {		
				name: 'question-answers',
				minLength: 2,
				items: 5,
				valueKey: 'title',
				limit: '10',
				remote: {
				   url: urlQuery,
				   filter: function(data) {
				   	if (data.status == 'FAILURE') {
				   		return '';
				   	};
				       return data.response.content;
				   }
				},		 
				template: '<span><p>{{title}}</p></span>',
				engine: Hogan,
				header: '<h4 style="margin-left:15px;padding:2px 0px">Questions and Answers</h4>'
			},
			/*{
				name: 'resources',
				minLength: 2,
				items: 5,
				valueKey: 'name',
				limit: '10',
				remote: {
				   url: resourceUrl,			   
				   filter: function(data) {
				   	if (data.status == 'FAILURE') {
				   		return '';
				   	};
				       return data.response;
				   }
				},		 
				template: '<span><p>{{name}}</p></span>',
				engine: Hogan,
				header: '<h4 style="margin-left:15px;padding:2px 0px">Resources</h4>'
			},*/
			{
				name: 'tags',
				minLength: 2,
				items: 5,
				valueKey: 'name',
				limit: '10',
				remote: {
				   url: tagsUrl,			   
				   filter: function(data) {
				   	if (data.status == 'FAILURE') {
				   		return '';
				   	};
				       return data.response;
				   }
				},		 
				template: '<span><p>{{name}}</p></span>',
				engine: Hogan,
				header: '<h4 style="margin-left:15px;padding:2px 0px">Tags</h4>'
			}
			]).on('typeahead:selected', function($e, data) {	
				dropDownValueSelectVal=true;
				if(data.title==undefined || data.title==null){
					window.location.href =  getBaseUrlOfSite()+"question/"+"tag/"+replaceSpaceWithhyphen(data.name);				
				}
				else{
					var title = replaceSpaceWithhyphen(data.title);
					window.location.href = getBaseUrlOfSite()+"question/"+data.docId+"/"+removeLastLetter(title);				
				}
			});
		    
		    /*.on('change', function($e, data){
			   alert($(this).val());
			});*/
	});
</script>
<style>
    .tt-dropdown-menu{
		max-height:400px!important;
	 	overflow:auto;
	 }
	 .tt-suggestion:nth-child(odd) {
  		background-color:#f6f6f6!important;
	}
	.tt-suggestions{
	    padding-top:5px;
		border-top:1px solid gray;
	}
	.tt-hint{
	   	top:-8px;
 	}
 	.tt-hint{
		width:643px;
  	}
  	.tt-dropdown-menu{
 	 	min-width:656px!important;
   	}
	.social_tooltip_popup,.anonymous_tooltip_popup,.report_flag_tooltip_popup
	{
      	text-align:center;
      	padding:10px;
      	color:black;
      	background-color:#FEF1E4;
      	width:215px;
      	position:absolute;
      	display:none;
      	border:1px solid gray;
      	z-index:1050;
      }
      .anonymous_tooltip_popup,.report_flag_tooltip_popup{
      	width:140px;
      	padding:5px;
      }      
   </style>
<div id="user_unauth_div_containere">
    <div th:include="signupFormTemplate"></div>
	<div th:include="loginAndSignupFormTemplate"></div>
	<div th:include="forgotPasswordFormTemplate"></div>
	<div th:include="messagePageTemplate"></div>
	<div th:include="addEmailFormTemplate"></div>
	<a id="error_message_link" data-toggle="modal" href="#messageModal" data-dismiss="modal" style="width:0px;height:0px" data-backdrop="static"></a>
	<a id="login-signup-form_link" data-toggle="modal" href="#loginSignupFormModal" data-dismiss="modal" style="width:0px;height:0px"></a>	
	<a id="add_email_form_link" data-toggle="modal" href="#addEmailFormModel" data-dismiss="modal" style="width:0px;height:0px" data-backdrop="static"></a>
</div>
<div class="header-profile-page">  
	<div class="navbar navbar-inverse nav">
	    <div class="navbar-inner">
	        <div class="container">
	           <div class="menu-bar-logo" style="width:50px;float:left;padding:10px;">
					<img id="showLeftPush" src="" style="width:30px;height:25px;cursor: pointer;"></img>
				</div>
	           <div class="pull-left" style="width:102px;margin-left:50px;margin-top: 5px;">
	           		<div id="main_logo_div_container" class="menu-selecticon" style="width:100px;height:30px;cursor:pointer;display:none" onclick="sendRedirect('search')">
	           		 	<img id="main_logo_div_container_img" src="" style="width:95px;height:30px;"></img>
	           		</div>
	            </div>	            
	           <div class="pull-right">	
	             <ul class="nav pull-right">	
	                 <li class="dropdown" sec:authorize="isAuthenticated()">	                   
	                 	<span sec:authorize="isAuthenticated()"> 
    						<span style="display:none;" id="auth_image_url" sec:authentication="principal.profile.profileSmallPictureUrl"/>
    						<span style="display:none;" id="current_login_user_id" sec:authentication="principal.id"/>
    						<span style="display:none;" id="current_login_user_profile_password" sec:authentication="principal.profile.password"/>
    		        		<span style="display:none;" id="current_login_user_profile_email" sec:authentication="principal.profile.email"/>
    		        		<span style="display:none" id="current_user_login_from" sec:authentication="principal.primarySocialNetworkConnection"></span>
    		        		<span  sec:authentication="principal.id" id="user_id" style="display:none"></span> 
    		        	</span>
	                    <a href="#" data-toggle="dropdown">
	                 		<span sec:authorize="isAuthenticated()"> 
    							Hi, <!-- <span id="authName" sec:authentication="principal.profile.firstname"/> -->
    							<span id="authName"/>!
	                 			<img id="user_image" style="margin-left:5px;width:18px;height:18px;"></img>
	                 			<b class="caret"></b>
	                 		</span>
	                 	</a>
	                    <ul class="dropdown-menu">
	                        <li id="admin_li">
	                         	<a href="javascript:sendRedirect('admin')">
	                         		<i class="icon-prof"></i>Admin
	                         	</a>
	                         </li>
	                         <li class="divider" id="admin_li_seprator"></li>
	                         <li>
	                         	<a href="javascript:sendRedirect('dashboard')">
	                         		<i class="icon-prof"></i>Dashboard
	                         	</a>
	                         </li>
	                         <li class="divider"></li>
	                         <li>
	                         	<a href="javascript:sendRedirect('settings')">
	                         		<i class="icon-cog"></i>Settings
	                         	</a>
	                         </li>	               
	                         <li class="divider"></li>
	                         <li>
	                         	<a href="javascript:sendRedirect('logout')">
	                         		<i class="icon-off"></i>Logout
	                         	</a>
	                         </li>
	                     </ul>
	                 </li>
	                 <li style="font-size: 12px; margin-top: 10px; margin-right:20px">
	                	<span sec:authorize="! isAuthenticated()">
	                		<b><a id="login-signup-form_link" data-toggle="modal" href="#signupFormModal" onclick="resetSignUpForm()">JOIN</a>&nbsp;|&nbsp;<a data-toggle="modal" href="#loginSignupFormModal" onclick="resetSignUpForm()">LOGIN</a></b>
	                	</span>
	                </li>
	             </ul>
	           </div>
	        </div>
	    </div>
	</div>
	<div id="top_header_search_question" style="height:30px;position:fixed;top:5px;left:240px;z-index:1000;display:none;"> 
		<!-- <span><img src="./img/logo-full-white.png" style="width:100px;height:30px;float:left;margin-left:10px;"/></span> -->
		<span style="width:568px;margin-left:10px;">
			<input id="search_home_control" style="width:625px;padding-right:25px;background-color:white;" type="text"
						placeholder='Search or ask your money-related question (i.e."What is a credit score?" or type a word/phrase "student loans")' autocomplete="off" />
		</span>	 
	    <span onclick="searchByKeyword('search_home')"  class="seach-icon-logo" style="height: 20px;position: absolute;right:5px;top: 5px;width: 20px;z-index: 1000;cursor: pointer;"></span>  
    </div>
    <nav class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-left" id="cbp-spmenu-s1" style="z-index:-1;">
	  <div style="width:250px;min-height:47px;backgroung-color:white;">
      </div>
      <h3 style="padding:10px;">Menu</h3>
      <a href="javascript:sendRedirect('search')" id="search">Search</a>
      <a href="javascript:sendRedirect('trending')" id="trending">Trending Questions</a>
      <a href="http://www.phroogal.com/question/tag/Reviews"  target="_self" id="trending">Trending Reviews</a>
      <a href="javascript:sendRedirect('trendingtags')">Trending Tags</a>
      <!-- <a href="http://www.phroogal.com/question/tag/Reviews"  target="_self">Reviews</a> -->
      <a href="javascript:sendRedirect('recent')" id="recent">Recent Questions</a>
      <a href="javascript:sendRedirect('recentanswers')">Recent Answers</a>     
      <a href="javascript:sendRedirect('unanswered')" id="unanswered">Unanswered Questions</a>
      <a href="javascript:sendRedirect('addquestion')"  id="addquestion">Add Questions</a>
      <div class="links_seprator" style="height:2px;background-color:white;margin:4px"></div>
      <a href="javascript:sendRedirect('personalfinance')" id="unanswered">Personal Finance 101</a>
      <a href="http://creditunion.phroogal.com" target="_blank" id="addquestion">Credit Union Resources</a> 
      <a href="javascript:sendRedirect('governmentresources')">Government Resources</a>
           
      <div class="copyright">
      	<img id="slider_footer_logo" src="" title="Logo" alt="Logo" width="130">
      	<div sec:authorize="!isAuthenticated()">
	      	<!--<p>Join us in breaking the social <br />taboo on money.</p>-->
	      	<div class="row_left_bar" align="center">
	        	<div style="width:220px;">
		        	<div class="join-btn md-trigger" data-modal="modal-join">
		        		<a data-toggle="modal" href="#signupFormModal" onclick="resetSignUpForm()" title="Join">Join Now</a>
		        	</div>
	        	</div>
	       	 	<div class="col-md-1"></div>
	       	</div>
       	</div>
      </div>
    </nav>
    
    <div class="alertMessage" id="alertMessageQuestionSave" style="display:none;">
  		Thanks phroogie! Your question is now sent to <br/>
  		the community. In the meantime search related <br/>
  		questions, topics and external resources.
  		<input type="button" value="ok" class="ok" />
	</div>	
	<script type="text/javascript">
       $(document).ready(function () { 
    	   // setting scroll hidden   	   
    	   $('body').css('overflow','hidden');
    	   
    	   // setting slider logos     	   
    	   var imageUrl1=getBaseUrlOfSite()+'img/img-slider/search.png';
    	   var imageUrl2=getBaseUrlOfSite()+'img/img-slider/chat.png';
    	   var imageUrl3=getBaseUrlOfSite()+'img/img-slider/time.png';
    	   var imageUrl4=getBaseUrlOfSite()+'img/img-slider/question.png';
    	   var imageUrl5=getBaseUrlOfSite()+'img/img-slider/add.png';
     	  
    	   $('#search').css('background-image','url(' + imageUrl1 + ')');
    	   $('#trending').css('background-image','url(' + imageUrl2 + ')');
    	   $('#recent').css('background-image','url(' + imageUrl3 + ')');
    	   $('#unanswered').css('background-image','url(' + imageUrl4 + ')');
    	   $('#addquestion').css('background-image','url(' + imageUrl5 + ')');
    	   
    	   // setting foooter logo of panel    	   
    	   $("#slider_footer_logo").attr("src",getBaseUrlOfSite()+"img/img-slider/logo-footer.png");
    	   
    	 //set logo url 
    	   $("#main_logo_div_container_img").attr("src",getBaseUrlOfSite()+"img/logo-full-white.png");
    	   var search_icon_url=getBaseUrlOfSite()+'img/search_icon.png';
		   $(".seach-icon-logo").css("backgroundImage","url('"+search_icon_url+"')");
		
    	   // setting footer social icon logo
    	   $("#footer_fb_social_link_img").attr("src",getBaseUrlOfSite()+"img/socialIcons/fb-gray-icon.png");
    	   $("#footer_twitter_social_link_img").attr("src",getBaseUrlOfSite()+"img/socialIcons/twitter-gray-icon.png");
    	   
    	   $('#search_home_control').keyup(function(e){
			    if (e.which === 13) {
			    	if(dropDownValueSelectVal==false){
			    		searchByKeyword('search_home'); 
			    	} 
			    }
			});           
        	$('.dropdown-toggle').dropdown();
        	var height=$(window).height();
        	//alert("window height is:"+height);
        	var containerHeight=height-($(".navbar-inner").height()+$(".profile-footer").height()+4)+"px";
        	//alert("mid container height is:"+containerHeight);
         	$(".main-container").css("margin-top","47px");
    		$(".main-container").css("height",containerHeight); 
    		$(".blog_container").css("height",containerHeight);
    		var containerHeight_slider=height-$(".profile-footer").height()+"px";        	
    		$("#cbp-spmenu-s1").css("height",containerHeight_slider);
    	    var userImageUrl=$("#auth_image_url").text();
    		console.log("getting url is"+userImageUrl);
    		if(userImageUrl=="" || userImageUrl==null){
				$("#user_image").attr("src",getBaseUrlOfSite()+"img/default-user.png");
			}
    		else{
				if(userImageUrl.trim().indexOf("https") !=-1 || userImageUrl.trim().indexOf("http")!= -1){
					$("#user_image").attr("src",userImageUrl); 
				}
				else{
					$("#user_image").attr("src",getBaseUrlOfSite()+userImageUrl);
				} 
			}
			$("#showLeftPush").attr("src",getBaseUrlOfSite()+"img/logo/Menu-bar.png")
			// showing tool tip
			$("#facebook_signup").hover(
	   	  		function(){
	   	  			var topSignFormH=$("#info_message_sign_form_alert_show").height();
	   	    		$("#facebook_popup_signup").css("top",topSignFormH+112+"px");
	   	    		$("#facebook_popup_signup").show();
	   	  		},   	    			
	   	  		function(){
	   	  			$("#facebook_popup_signup").hide();
	   	  		}
	       	);
			$("#twitter_signup").hover(
	   	  		function(){
	   	  			var topSignFormH=$("#info_message_sign_form_alert_show").height();
	   	    		$("#twitter_popup_signup").css("top",topSignFormH+154+"px");
	   	      		$("#twitter_popup_signup").show();
	   	  		},   	    			
	   	  		function(){
	   	  			$("#twitter_popup_signup").hide();
	   	  		}
	       	);
			$("#facebook_login").hover(
	   	  		function(){
	   	  			var topLoginFormH=$("#info_message_login_form_alert_show").height();
	   	    		$("#facebook_popup_login").css("top",topLoginFormH+112+"px");
	   	    		$("#facebook_popup_login").show();
	   	  		},   	    			
	   	  		function(){
	   	  			$("#facebook_popup_login").hide();
	   	  		}
	       	);
			$("#twitter_login").hover(
	   	  		function(){
	   	  			var topLoginFormH=$("#info_message_login_form_alert_show").height();
	   	    		$("#twitter_popup_login").css("top",topLoginFormH+154+"px");
	   	    		$("#twitter_popup_login").show();
	   	  		},   	    			
	   	  		function(){
	   	  			$("#twitter_popup_login").hide();
	   	  		}
	       	);
        });
        $(window).resize(function(){
        	var height=$(window).height(); 
        	var containerHeight=height-($(".navbar-inner").height()+$(".profile-footer").height()+4)+"px";
    		$(".main-container").css("height",containerHeight); 
    		var containerHeight_slider=height-$(".profile-footer").height()+"px";        	
    		$("#cbp-spmenu-s1").css("height",containerHeight_slider);
       });
       $(document).ready(function () { 
       	var user_login_id = $("#current_login_user_id").text();
       	var user_login_password=$("#current_login_user_profile_password").text();
       	var current_user_login_from=$("#current_user_login_from").text();
   		if(user_login_id!=""){
   			if((current_user_login_from=="TWITTER")){
   				var checkFlag=checkLoginUserEmailExist(user_login_id);
   				console.log("getting true false from check flag value is "+checkFlag);
	       		if(checkFlag){
	       			showTwitterUserAddEmailForm();
	       		}
       		}
   			else{
   				checkLoginUserEmailExist(user_login_id);
   			}
   		}
   	});     
   </script>
    <script type="text/javascript">
      var menuLeft = document.getElementById( 'cbp-spmenu-s1' ),
      showLeftPush = document.getElementById( 'showLeftPush' ),
      body = document.body;
      showLeftPush.onclick = function() {
      classie.toggle( this, 'active' );
      classie.toggle( body, 'cbp-spmenu-push-toright' );
      classie.toggle( menuLeft, 'cbp-spmenu-open' );
      disableOther( 'showLeftPush' );
      };
      $("#showLeftPush").mouseenter(function(){
    	   classie.toggle( this, 'active' );
    	   classie.toggle( body, 'cbp-spmenu-push-toright' );
    	   classie.toggle( menuLeft, 'cbp-spmenu-open' );
    	   disableOther( 'showLeftPush' );
   	  });
	  $("#cbp-spmenu-s1").mouseleave(function(){ 
		   classie.toggle( this, 'active' );
		   classie.toggle( body, 'cbp-spmenu-push-toright' );
		   classie.toggle( menuLeft, 'cbp-spmenu-open' );
		   disableOther( 'showLeftPush' );
	  });
    </script>   	
   
</div>
